# 이 프로젝트를 리팩토링하면서 고민하던 것들에 대한 기록

## 2022-08-10

### 이미지 파일 업로드 시 같은 이름의 파일은 하나로 통합해서 해야 할까?

다른 폴더에 있는, 같은 이름이지만 다른 이미지 파일을 업로드할 수도 있지 않을까?

결론. 그래서 같은 이름의 파일이라도 독립적인 하나의 파일로 처리한다.

### 전역 객체 및 전역 함수의 네이밍 중복을 어떻게 해결해야 할까?

기능 단위로 클래스를 설계해서 필요한 곳에 클래스를 생성해서 사용한다면 데이터 절약에 유지보수도 좋지 않을까? 자바스크립트이니까, 클래스를 만들지 않아도 객체로도 가능 할 것 같다.

파일을 대표하는 하나의 객체(Object)에 변수나 함수를 모두 담아서 사용할 수 있지 않을까? 이렇게 해보는걸로!

적용해보니... this 키워드로 접근하는 코드를 작성하면서 몇 가지 주의가 필요했다.

1. 이벤트 리스너 핸들러 함수의 this는 호출한 Element를 가리킨다는 것
2. 비동기 처리 함수의 경우(then 등) this는 전역 스코프를 가리킨다는 것

그래서 비동기 처리 함수는 동기적인 처리가 필요하다고 판단되면 async/await 문법으로
변경하고, 이벤트 리스너 핸들러 함수에는 this 대신 해당 오브젝트로 직접 접근하도록
변경하였다.

## 2022-08-23

### 페이지로 분리해보니.. 기능별로 또 분리해야하나 싶다

리팩토링을 통해 공통적으로 사용하는 Utils,  페이지별 기능을 하나의 오브젝트로 담는데는 성공해서 전보단 나은 코드지만,
확장이나 유지 보수를 고려하면 더 세부적으로 기능 단위로 분리시키는 것이 낫겠다는 판단을 한다.

하지만.. 새로운 프로젝트를 시작하고 싶어서 리팩토링은 여기까지만 마무리할 것이다.

사실, 리팩토링의 정의는 기능의 변화 없이 시스템을 재구성 하는 것이다.
하지만 나는 리팩토링 및 기능을 추가하고 버그 수정까지.. 좋아좋아

그래도 남아있는 과제들은 끝내야겠지? 깃허브 이슈에 작성한 과제는 제대로 해보고 마무리 짓는 것으로~~

## 2022-08-31

게시판 글을 수정할 때, 이미지의 변경 유무를 확인해야 한다. 추가, 삭제, 유지되는 것들에 대해 처리해야하는데..
그런데 이런 확인 과정 및 처리 과정을 클라이언트에서 해야할지 서버에서 해야할지, 역할과 책임을 나누는 일은 어렵다.

클라이언트에게 역할과 책임을 부여한다면, 업데이트 전 게시판 데이터를 요청하여 받아와 현재 업로드 하려는 데이터와
비교하여 이미지파일 삭제 요청을 한다. 그리고 최종적으로 게시판 수정을 요청하는 것이다.

처음에는 게시판 업로드 요청에 삭제할 파일까지 Body에 포함시켜서 보내서 서버에서 처리해야 하나 싶었는데,
이미지 파일 삭제와 게시판 업로드는 별도의 기능이라 생각해서 최대한 기능을 나누는 것이 좋겠다.
